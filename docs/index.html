<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vehicular Emissions Inventories • vein</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Vehicular Emissions Inventories">
<meta property="og:description" content="Elaboration of vehicular emissions inventories,
    consisting in four stages, pre-processing activity data, preparing 
    emissions factors, estimating the emissions and post-processing of emissions 
    in maps and databases. More details in Ibarra-Espinosa et al (2018) &lt;doi:10.5194/gmd-11-2209-2018&gt;.
    Before using VEIN you need to know the vehicular composition of your study area, in other words,
    the combination of of type of vehicles, size and fuel of the fleet. Then, it is recommended to
    start with the project to download a template to create a structure of directories and scripts.">
<meta property="og:image" content="http://atmoschem.github.io/vein/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-2642843-5"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-2642843-5');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">vein</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/basics.html">Basics for running VEIN</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/atmoschem/vein/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div class="section level1">
<div class="page-header"><h1 id="vein-">VEIN <img src="reference/figures/logo.png" align="right" alt="" width="220"><a class="anchor" aria-label="anchor" href="#vein-"></a>
</h1></div>
<ul>
<li>build: <a href="https://ci.appveyor.com/project/ibarraespinosa/vein" class="external-link"><img src="https://ci.appveyor.com/api/projects/status/github/ibarraespinosa/vein?branch=master&amp;svg=true" alt="AppVeyor Build Status"></a> <a href="https://codecov.io/github/atmoschem/vein?branch=master" class="external-link"><img src="https://img.shields.io/codecov/c/github/atmoschem/vein/master.svg" alt="Coverage Status"></a>
</li>
<li>cran: <a href="http://cran.rstudio.com/web/packages/vein/index.html" class="external-link"><img src="http://cranlogs.r-pkg.org/badges/vein"></a> <a href="http://cran.r-project.org/web/packages/vein" class="external-link"><img src="http://www.r-pkg.org/badges/version/vein" alt="CRAN_Status_Badge"></a> <a href="http://cran.r-project.org/package=vein" class="external-link"><img src="http://cranlogs.r-pkg.org/badges/grand-total/vein?color=orange" alt="CRAN Downloads"></a> <a href="https://www.tidyverse.org/lifecycle/#maturing" class="external-link"><img src="https://img.shields.io/badge/lifecycle-maturing-blue.svg" alt="Package Status"></a> <img src="https://img.shields.io/cran/l/vein?style=plastic" alt="CRAN/METACRAN">
</li>
<li>doi: <a href="https://zenodo.org/badge/latestdoi/88201850" class="external-link"><img src="https://zenodo.org/badge/88201850.svg" alt="DOI"></a>
</li>
<li>github: <a href="https://github.com/atmoschem/vein" class="external-link"><img src="https://img.shields.io/github/stars/atmoschem/vein.svg?style=social&amp;label=Github" alt="Github Stars"></a> <img src="https://img.shields.io/github/languages/code-size/atmoschem/vein" alt="GitHub code size in bytes"><img src="https://img.shields.io/github/issues/atmoschem/vein" alt="GitHub issues"><!-- ![Liberapay giving](https://img.shields.io/liberapay/gives/sergio.ibarra) --><img src="https://img.shields.io/github/commit-activity/y/ibarraespinosa/vein" alt="GitHub commit activity"><a href="https://github.com/atmoschem/vein/actions" class="external-link"><img src="https://github.com/atmoschem/vein/workflows/R-CMD-check/badge.svg" alt="R build status"></a>
</li>
</ul>
<!-- ![](https://github.com/atmoschem/vein/raw/master/all_comp.gif) -->
</div>
<div class="section level1">
<h1 id="vehicular-emissions-inventories-vein">
<strong>V</strong>ehicular <strong>E</strong>missions <strong>IN</strong>ventories (VEIN)<a class="anchor" aria-label="anchor" href="#vehicular-emissions-inventories-vein"></a>
</h1>
<p><img src="https://i.imgur.com/stnHJQx.png"></p>
<div class="section level3">
<h3 id="todo">TODO<a class="anchor" aria-label="anchor" href="#todo"></a>
</h3>
<ul>
<li>get_project with Chinese EF</li>
<li>Include speed functions with Fortran</li>
<li>Include CB6</li>
<li>Add EF from HBEFA?</li>
<li>See issues <a href="https://github.com/atmoschem/vein/issues" class="external-link">GitHub</a> and <a href="https://gitlab.com/ibarraespinosa/vein/-/issues" class="external-link">GitLab</a>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="system-requirements">System requirements<a class="anchor" aria-label="anchor" href="#system-requirements"></a>
</h3>
<p>vein imports functions from spatial packages listed below. In order to install these packages, firstly the user must install the requirements mentioned <a href="https://www.github.com/r-spatial/sf" class="external-link">here</a>.</p>
</div>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<div class="section level4">
<h4 id="cran">CRAN<a class="anchor" aria-label="anchor" href="#cran"></a>
</h4>
<p>VEIN can be installed via CRAN or github</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"vein"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="github">GitHub<a class="anchor" aria-label="anchor" href="#github"></a>
</h4>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"atmoschem/vein"</span><span class="op">)</span></code></pre></div>
<p>or if you have a <strong>32 bits</strong> machine</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">install_github</span><span class="op">(</span><span class="st">"atmoschem/vein"</span>,
INSTALL_opts <span class="op">=</span> <span class="st">"--no-multiarch"</span><span class="op">)</span></code></pre></div>
<hr>
</div>
<div class="section level4">
<h4 id="demo">demo<a class="anchor" aria-label="anchor" href="#demo"></a>
</h4>
<p>Then, if you want, run the demo</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/atmoschem/vein" class="external-link">vein</a></span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/utils/demo.html" class="external-link">demo</a></span><span class="op">(</span><span class="va">VEIN</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="section"></h3>
</div>
<div class="section level2">
<h2 id="approaches">Approaches<a class="anchor" aria-label="anchor" href="#approaches"></a>
</h2>
<div class="section level3">
<h3 id="1-get-a-project-easier">1. get a project (easier)<a class="anchor" aria-label="anchor" href="#1-get-a-project-easier"></a>
</h3>
<p>At the moment, most of the projects covers Brazilian regions, but I will include China, Europe or USA approaches as soon as I can.</p>
<p>Use the function <a href="https://atmoschem.github.io/vein/reference/get_project.html" class="external-link">get_project</a> and read the documentation, there you can see more projects as well.</p>
<ul>
<li><a href="https://github.com/atmoschem/vein/actions" class="external-link"><img src="https://github.com/atmoschem/vein/workflows/brazil_bu/badge.svg" alt="R build status"></a></li>
<li><a href="https://github.com/atmoschem/vein/actions" class="external-link"><img src="https://github.com/atmoschem/vein/workflows/brazil_bu_csvgz/badge.svg" alt="R build status"></a></li>
<li><a href="https://github.com/atmoschem/vein/actions" class="external-link"><img src="https://github.com/atmoschem/vein/workflows/brazil_bu_csv/badge.svg" alt="R build status"></a></li>
<li><a href="https://github.com/atmoschem/vein/actions" class="external-link"><img src="https://github.com/atmoschem/vein/workflows/brazil_td_chem/badge.svg" alt="R build status"></a></li>
<li><a href="https://github.com/atmoschem/vein/actions" class="external-link"><img src="https://github.com/atmoschem/vein/workflows/brazil_bu_chem/badge.svg" alt="R build status"></a></li>
<li><a href="https://github.com/atmoschem/vein/actions" class="external-link"><img src="https://github.com/atmoschem/vein/workflows/brazil_bu_chem_streets/badge.svg" alt="R build status"></a></li>
<li><a href="https://github.com/atmoschem/vein/actions" class="external-link"><img src="https://github.com/atmoschem/vein/workflows/sebr_cb05co2/badge.svg" alt="R build status"></a></li>
<li><a href="https://github.com/atmoschem/vein/actions" class="external-link"><img src="https://github.com/atmoschem/vein/workflows/amazon2014/badge.svg" alt="R build status"></a></li>
<li><a href="https://github.com/atmoschem/vein/actions" class="external-link"><img src="https://github.com/atmoschem/vein/workflows/masp2020/badge.svg" alt="R build status"></a></li>
<li>
<a href="https://github.com/atmoschem/vein/actions" class="external-link"><img src="https://github.com/atmoschem/vein/workflows/curitiba/badge.svg" alt="R build status"></a> <!-- - [![R build status](https://github.com/atmoschem/vein/workflows/ecuador_td_hot/badge.svg)](https://github.com/atmoschem/vein/actions) --> <!-- - [![R build status](https://github.com/atmoschem/vein/workflows/ecuador_td_hot_month/badge.svg)](https://github.com/atmoschem/vein/actions) -->
</li>
<li><a href="https://github.com/atmoschem/vein/actions" class="external-link"><img src="https://github.com/atmoschem/vein/workflows/ecuador_td/badge.svg" alt="R build status"></a></li>
<li><a href="https://github.com/atmoschem/vein/actions" class="external-link"><img src="https://github.com/atmoschem/vein/workflows/ecuador_td_im/badge.svg" alt="R build status"></a></li>
<li><a href="https://github.com/atmoschem/vein/actions" class="external-link"><img src="https://github.com/atmoschem/vein/workflows/brazil_bu_chem_im/badge.svg" alt="R build status"></a></li>
<li><a href="https://github.com/atmoschem/vein/actions" class="external-link"><img src="https://github.com/atmoschem/vein/workflows/brazil_bu_chem_streets_im/badge.svg" alt="R build status"></a></li>
<li><a href="https://github.com/atmoschem/vein/actions" class="external-link"><img src="https://github.com/atmoschem/vein/workflows/brazil_td_chem_im/badge.svg" alt="R build status"></a></li>
<li><a href="https://github.com/atmoschem/vein/actions" class="external-link"><img src="https://github.com/atmoschem/vein/workflows/sebr_cb05co2_im/badge.svg" alt="R build status"></a></li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/atmoschem/vein" class="external-link">vein</a></span><span class="op">)</span>
<span class="op">?</span><span class="va">get_project</span>
<span class="fu"><a href="reference/get_project.html">get_project</a></span><span class="op">(</span>directory <span class="op">=</span> <span class="st">"awesome_city"</span><span class="op">)</span></code></pre></div>
<p>The structure of the new directory “awesome_city” is:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>awesome_city</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>├── config</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>│   ├── clean.R</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>│   ├── config.R</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>│   ├── inventory.xlsx</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>│   └── packages.R</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>├── main.R</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>├── main.Rproj</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>├── network</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>│   ├── net.gpkg</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>│   └── net.rds</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>├── scripts</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>│   ├── evaporatives.R</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>│   ├── exhaust.R</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>│   ├── fuel_eval.R</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>│   ├── net.R</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>│   ├── pavedroads.R</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>│   ├── plots.R</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>│   ├── post.R</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>│   ├── traffic.R</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>│   └── wrf.R</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>└── wrf</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>└── wrfinput_d02</span></code></pre></div>
<p>You have to open the file <code>main.Rproj</code> with Rstudio and then open and run <code>main.R</code></p>
<p>To run <code>main.R</code> you will need these extra packages:</p>
<ul>
<li>ggplot2</li>
<li>readxl</li>
<li>eixport (If you plan to generate WRF Chem emissions file)</li>
</ul>
<p>If you do not have them already, you can install:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ggplot2"</span>, <span class="st">"readxl"</span>, <span class="st">"eixport"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="too-complicated-watch-a-youtube">Too complicated? Watch a YouTube<a class="anchor" aria-label="anchor" href="#too-complicated-watch-a-youtube"></a>
</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/tHSWIjg26vg" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<p><a href="https://www.youtube.com/embed/tHSWIjg26vg" class="external-link">English</a></p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/6-07Y0Eimng" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<p><a href="https://www.youtube.com/watch?v=6-07Y0Eimng" class="external-link">Portuguese</a></p>
<p>Spanish coming soon!</p>
<div class="section level3">
<h3 id="2-use-inventory-a-bit-not-so-easy">2. Use inventory (a bit not so easy)<a class="anchor" aria-label="anchor" href="#2-use-inventory-a-bit-not-so-easy"></a>
</h3>
<p>Read the instruction of inventory</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">?</span><span class="va">inventory</span></code></pre></div>
<div class="section level4">
<h4 id="1-examples-with-traffic-data">1) Examples with traffic data:<a class="anchor" aria-label="anchor" href="#1-examples-with-traffic-data"></a>
</h4>
<ol style="list-style-type: decimal">
<li>If you know the distribution of the vehicles by age of use , use: <a href="https://atmoschem.github.io/vein/reference/my_age.html" class="external-link">my_age</a>
</li>
<li>If you know the sales of vehicles or better the registry of new vehicles, use <a href="https://atmoschem.github.io/vein/reference/age.html" class="external-link">age</a> to apply a survival function.</li>
<li>If you know the theoretical shape of the circulating fleet and you can use <a href="https://atmoschem.github.io/vein/reference/age_ldv.html" class="external-link">age_ldv</a>, <a href="https://atmoschem.github.io/vein/reference/age_hdv.html" class="external-link">age_hdv</a> or <a href="https://atmoschem.github.io/vein/reference/age_moto.html" class="external-link">age_moto</a>. For instance, you dont know the sales or registry of vehicles, but somehow you know the shape of this curve.</li>
<li>You can use/merge/transform/adapt any of these functions.</li>
</ol>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/atmoschem/vein" class="external-link">vein</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"net"</span><span class="op">)</span>
<span class="va">PC_E25_1400</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/age_ldv.html">age_ldv</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="va">net</span><span class="op">$</span><span class="va">ldv</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>
  <span class="va">PC_E25_1400</span>
<span class="op">)</span>
<span class="co">#&gt; Weighted mean =  11.17</span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-3-1.png"><!-- --></p>
<p>If you want to know the vehicles per street and by age of use, just add the net. Age functions now returns ‘sf’ objects if the net argument is present.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">PC_E25_1400net</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/age_ldv.html">age_ldv</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="va">net</span><span class="op">$</span><span class="va">ldv</span>, 
  net <span class="op">=</span> <span class="va">net</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>
  <span class="va">PC_E25_1400net</span>, 
  key.pos <span class="op">=</span> <span class="fl">4</span>, 
  pal <span class="op">=</span> <span class="fu">cptcity</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/cptcity/man/cpt.html" class="external-link">cpt</a></span><span class="op">(</span>
    colorRampPalette <span class="op">=</span> <span class="cn">T</span>, 
    rev <span class="op">=</span> <span class="cn">T</span>
  <span class="op">)</span>
<span class="op">)</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; Warning: plotting the first 9 out of 50 attributes; use max.plot = 50 to plot</span>
<span class="co">#&gt; all</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-4-1.png"><!-- --></p>
<ul>
<li><a href="https://atmoschem.github.io/vein/reference/temp_fact.html" class="external-link">temp_fact</a></li>
<li><a href="https://atmoschem.github.io/vein/reference/netspeed.html" class="external-link">netspeed</a></li>
</ul>
<p>temporal factors and netspeed</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"net"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"pc_profile"</span><span class="op">)</span>
<span class="va">pc_week</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/temp_fact.html">temp_fact</a></span><span class="op">(</span>
  <span class="va">net</span><span class="op">$</span><span class="va">ldv</span> <span class="op">+</span> <span class="va">net</span><span class="op">$</span><span class="va">hdv</span>, 
  <span class="va">pc_profile</span>
<span class="op">)</span>
<span class="va">dfspeed</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/netspeed.html">netspeed</a></span><span class="op">(</span>
  q <span class="op">=</span> <span class="va">pc_week</span>, 
  ps <span class="op">=</span> <span class="va">net</span><span class="op">$</span><span class="va">ps</span>, 
  ffs <span class="op">=</span> <span class="va">net</span><span class="op">$</span><span class="va">ffs</span>, 
  cap <span class="op">=</span> <span class="va">net</span><span class="op">$</span><span class="va">capacity</span>, 
  lkm <span class="op">=</span> <span class="va">net</span><span class="op">$</span><span class="va">lkm</span>, 
  alpha <span class="op">=</span> <span class="fl">1.5</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dfspeed</span><span class="op">)</span>
<span class="co">#&gt; Weighted mean =  44.16</span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-5-1.png"><!-- --></p>
<p>If you want ot check the speed at different hours by street, just add net:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dfspeednet</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/netspeed.html">netspeed</a></span><span class="op">(</span>
  q <span class="op">=</span> <span class="va">pc_week</span>, 
  ps <span class="op">=</span> <span class="va">net</span><span class="op">$</span><span class="va">ps</span>, 
  ffs <span class="op">=</span> <span class="va">net</span><span class="op">$</span><span class="va">ffs</span>, 
  cap <span class="op">=</span> <span class="va">net</span><span class="op">$</span><span class="va">capacity</span>, 
  lkm <span class="op">=</span> <span class="va">net</span><span class="op">$</span><span class="va">lkm</span>,
  alpha <span class="op">=</span> <span class="fl">1.5</span>, 
  net <span class="op">=</span> <span class="va">net</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>
  <span class="va">dfspeednet</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S1"</span>, <span class="st">"S9"</span><span class="op">)</span><span class="op">]</span>, 
  key.pos <span class="op">=</span> <span class="fl">4</span>, 
  pal <span class="op">=</span> <span class="fu">cptcity</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/cptcity/man/cpt.html" class="external-link">cpt</a></span><span class="op">(</span>colorRampPalette <span class="op">=</span> <span class="cn">T</span>, 
                     rev <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, 
  axes <span class="op">=</span> <span class="cn">T</span>
<span class="op">)</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-6-1.png"><!-- --> #### 2) Emission Factors</p>
<ul>
<li><a href="https://atmoschem.github.io/vein/reference/ef_ldv_speed.html" class="external-link">ef_ldv_speed</a></li>
<li><a href="https://atmoschem.github.io/vein/reference/ef_hdv_speed.html" class="external-link">ef_hdv_speed</a></li>
<li><a href="https://atmoschem.github.io/vein/reference/ef_ldv_scaled.html" class="external-link">ef_ldv_scaled</a></li>
<li><a href="https://atmoschem.github.io/vein/reference/ef_hdv_scaled.html" class="external-link">ef_hdv_scaled</a></li>
<li><a href="https://atmoschem.github.io/vein/reference/EmissionFactors.html" class="external-link">EmissionFactors</a></li>
<li><a href="https://atmoschem.github.io/vein/reference/EmissionFactorsList.html" class="external-link">EmissionFactorsList</a></li>
</ul>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">V</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">150</span>
<span class="va">ef1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ef_ldv_speed.html">ef_ldv_speed</a></span><span class="op">(</span>
  v <span class="op">=</span> <span class="st">"PC"</span>,
  t <span class="op">=</span> <span class="st">"4S"</span>, 
  cc <span class="op">=</span> <span class="st">"&lt;=1400"</span>, 
  f <span class="op">=</span> <span class="st">"G"</span>,
  eu <span class="op">=</span> <span class="st">"PRE"</span>,
  p <span class="op">=</span> <span class="st">"CO"</span>
<span class="op">)</span>
<span class="va">efs</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/EmissionFactors.html">EmissionFactors</a></span><span class="op">(</span><span class="fu">ef1</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">150</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>
  <span class="fu"><a href="reference/Speed.html">Speed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">150</span><span class="op">)</span>, 
  <span class="va">efs</span>, 
  xlab <span class="op">=</span> <span class="st">"speed[km/h]"</span>, 
  type <span class="op">=</span> <span class="st">"b"</span>, 
  pch <span class="op">=</span> <span class="fl">16</span>
<span class="op">)</span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-7-1.png"><!-- --></p>
</div>
<div class="section level4">
<h4 id="3-estimation-of-emissions">3) Estimation of emissions<a class="anchor" aria-label="anchor" href="#3-estimation-of-emissions"></a>
</h4>
<ul>
<li><a href="https://atmoschem.github.io/vein/reference/emis.html" class="external-link">emis</a></li>
</ul>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">euro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"V"</span>, <span class="fl">5</span><span class="op">)</span>, 
  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"IV"</span>, <span class="fl">5</span><span class="op">)</span>, 
  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"III"</span>, <span class="fl">5</span><span class="op">)</span>, 
  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"II"</span>, <span class="fl">5</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"I"</span>, <span class="fl">5</span><span class="op">)</span>, 
  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"PRE"</span>, <span class="fl">15</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">lef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">40</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="reference/ef_ldv_speed.html">ef_ldv_speed</a></span><span class="op">(</span>
    v <span class="op">=</span> <span class="st">"PC"</span>, 
    t <span class="op">=</span> <span class="st">"4S"</span>,
    cc <span class="op">=</span> <span class="st">"&lt;=1400"</span>, 
    f <span class="op">=</span> <span class="st">"G"</span>,
    eu <span class="op">=</span> <span class="va">euro</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, 
    p <span class="op">=</span> <span class="st">"CO"</span>, 
    show.equation <span class="op">=</span> <span class="cn">FALSE</span>
  <span class="op">)</span> 
<span class="op">}</span><span class="op">)</span>
<span class="va">E_CO</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/emis.html">emis</a></span><span class="op">(</span>
  veh <span class="op">=</span> <span class="va">PC_E25_1400</span>, 
  lkm <span class="op">=</span> <span class="va">net</span><span class="op">$</span><span class="va">lkm</span>, 
  ef <span class="op">=</span> <span class="va">lef</span>, 
  speed <span class="op">=</span> <span class="va">dfspeed</span>,
  profile <span class="op">=</span> <span class="va">pc_profile</span>
<span class="op">)</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="4-post-emissions">4) Post Emissions<a class="anchor" aria-label="anchor" href="#4-post-emissions"></a>
</h4>
<ul>
<li><a href="https://atmoschem.github.io/vein/reference/emis_post.html" class="external-link">emis_post</a></li>
<li>When the argument by = “veh” the emissions are aggregated by age and hour.</li>
<li>When the argument by = “streets_wide”, aggregated the emissions by street. In this cae, if you add the argument net with the respective streets, it returns an spatial net with the hourly emissions.</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">E_CO_DF</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/emis_post.html">emis_post</a></span><span class="op">(</span>
  arra <span class="op">=</span> <span class="va">E_CO</span>,  
  veh <span class="op">=</span> <span class="st">"PC"</span>, 
  size <span class="op">=</span> <span class="st">"&lt;1400"</span>, 
  fuel <span class="op">=</span> <span class="st">"G"</span>,
  pollutant <span class="op">=</span> <span class="st">"CO"</span>, 
  by <span class="op">=</span> <span class="st">"veh"</span>, 
  type_emi <span class="op">=</span> <span class="st">"exhaust"</span>
<span class="op">)</span>
<span class="va">E_CO_STREETS</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/emis_post.html">emis_post</a></span><span class="op">(</span>
  arra <span class="op">=</span> <span class="va">E_CO</span>, 
  pollutant <span class="op">=</span> <span class="st">"CO"</span>, 
  by <span class="op">=</span> <span class="st">"streets"</span>, 
  net <span class="op">=</span> <span class="va">net</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>
  <span class="va">E_CO_STREETS</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"V1"</span>, <span class="st">"V9"</span><span class="op">)</span><span class="op">]</span>, 
  key.pos <span class="op">=</span> <span class="fl">4</span>, 
  pal <span class="op">=</span> <span class="fu">cptcity</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/cptcity/man/cpt.html" class="external-link">cpt</a></span><span class="op">(</span>colorRampPalette <span class="op">=</span> <span class="cn">T</span>, 
                     rev <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, 
  axes <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-9-1.png"><!-- --></p>
</div>
<div class="section level4">
<h4 id="grids">Grids<a class="anchor" aria-label="anchor" href="#grids"></a>
</h4>
<ul>
<li>
<a href="https://atmoschem.github.io/vein/reference/make_grid.html" class="external-link">make_grid</a>.</li>
</ul>
<ol style="list-style-type: decimal">
<li>Create a grid using <code>make_grid</code>.The spobj is the spatial net. The size of the grid has the size of the net. You have to specify the grid spacing.</li>
<li>Create a grid using a path to wrfinput file instead a net. The grid will have the size of the wrf_input. You don’t have to specify the grid spacing.</li>
</ol>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span>
<span class="va">E_CO_STREETSnet</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/emis_post.html">emis_post</a></span><span class="op">(</span>
  arra <span class="op">=</span> <span class="va">E_CO</span>, 
  pollutant <span class="op">=</span> <span class="st">"CO"</span>,
  by <span class="op">=</span> <span class="st">"streets_wide"</span>,
  net <span class="op">=</span> <span class="va">net</span>
<span class="op">)</span>
<span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/make_grid.html">make_grid</a></span><span class="op">(</span>
  spobj <span class="op">=</span> <span class="va">net</span>, 
  width <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">102.47</span>
<span class="op">)</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; Number of lon points: 12</span>
<span class="co">#&gt; Number of lat points: 10</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="va">E_CO_g</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/emis_grid.html">emis_grid</a></span><span class="op">(</span>
  spobj <span class="op">=</span> <span class="va">E_CO_STREETSnet</span>, 
  g <span class="op">=</span> <span class="va">g</span>, 
  sr<span class="op">=</span> <span class="fl">31983</span>
<span class="op">)</span>
<span class="co">#&gt; Your units are:</span>
<span class="co">#&gt; g</span>
<span class="co">#&gt; Transforming spatial objects to 'sr'</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; Sum of street emissions 148791715.29</span>
<span class="co">#&gt; Sum of gridded emissions 148791715.29</span>
<span class="va">na</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"V"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">168</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">168</span><span class="op">)</span> <span class="va">E_CO_g</span><span class="op">[[</span><span class="va">na</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">E_CO_g</span><span class="op">[[</span><span class="va">na</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">]</span> <span class="op">*</span> <span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/units/man/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"1/h"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>
  <span class="va">E_CO_g</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"V1"</span>, <span class="st">"V9"</span><span class="op">)</span><span class="op">]</span>, 
  key.pos <span class="op">=</span> <span class="fl">4</span>, 
  pal <span class="op">=</span> <span class="fu">cptcity</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/cptcity/man/cpt.html" class="external-link">cpt</a></span><span class="op">(</span>colorRampPalette <span class="op">=</span> <span class="cn">T</span>, 
                     rev <span class="op">=</span> <span class="cn">T</span>,
                     pal <span class="op">=</span> <span class="st">"mpl_viridis"</span><span class="op">)</span>, 
  axes <span class="op">=</span> <span class="cn">T</span>, 
  lty <span class="op">=</span> <span class="fl">0</span>
<span class="op">)</span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-10-1.png"><!-- --></p>
</div>
<div class="section level4">
<h4 id="creating-a-wrfchem-input-file-using-eixport">Creating a WRFChem Input file using <a href="https://atmoschem.github.io/eixport/" class="external-link">eixport</a>:<a class="anchor" aria-label="anchor" href="#creating-a-wrfchem-input-file-using-eixport"></a>
</h4>
<ol style="list-style-type: decimal">
<li>Create a grid using <a href="https://atmoschem.github.io/vein/reference/make_grid.html" class="external-link">make_grid</a> and a wrfinput file</li>
<li>Run <a href="https://atmoschem.github.io/vein/reference/emis_grid.html" class="external-link">emis_grid</a> to grid your emissions.</li>
<li>Create a <a href="https://atmoschem.github.io/vein/reference/GriddedEmissionsArray.html" class="external-link">GriddedEmissionsArray</a>.</li>
<li>Create a wrfchem input file [eixport::wrf_create](<a href="https://atmoschem.github.io/eixport/reference/wrf_create.html" class="external-link uri">https://atmoschem.github.io/eixport/reference/wrf_create.html</a>.</li>
<li>Put the <a href="https://atmoschem.github.io/vein/reference/GriddedEmissionsArray.html" class="external-link">GriddedEmissionsArray</a> into the wrf chem input file using <a href="https://atmoschem.github.io/eixport/reference/wrf_put.html" class="external-link">eixport::wrf_put</a>.</li>
</ol>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://atmoschem.github.io/eixport/" class="external-link">eixport</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"EMISS"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://atmoschem.github.io/eixport/reference/wrf_create.html" class="external-link">wrf_create</a></span><span class="op">(</span>wrfinput_dir         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"eixport"</span><span class="op">)</span>,
wrfchemi_dir         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"EMISS"</span><span class="op">)</span>,
domains              <span class="op">=</span> <span class="fl">2</span>,
frames_per_auxinput5 <span class="op">=</span> <span class="fl">1</span>, <span class="co">#hours</span>
auxinput5_interval_m <span class="op">=</span> <span class="fl">60</span>,
verbose              <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">path_to_wrfi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"eixport"</span><span class="op">)</span>, <span class="st">"/wrfinput_d02"</span><span class="op">)</span>
<span class="va">path_to_wrfc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"EMISS"</span><span class="op">)</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="va">gwrf</span> <span class="op">&lt;-</span> <span class="fu">eixport</span><span class="fu">::</span><span class="fu"><a href="https://atmoschem.github.io/eixport/reference/wrf_grid.html" class="external-link">wrf_grid</a></span><span class="op">(</span><span class="va">path_to_wrfi</span><span class="op">)</span>
<span class="va">E_CO_gwrf</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/emis_grid.html">emis_grid</a></span><span class="op">(</span>spobj <span class="op">=</span> <span class="va">E_CO_STREETSnet</span>, g <span class="op">=</span> <span class="va">gwrf</span><span class="op">)</span>
<span class="va">gr</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/GriddedEmissionsArray.html">GriddedEmissionsArray</a></span><span class="op">(</span><span class="va">E_CO_gwrf</span>, rows <span class="op">=</span> <span class="fl">51</span>, cols <span class="op">=</span> <span class="fl">63</span>, times <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="fu">eixport</span><span class="fu">::</span><span class="fu"><a href="https://atmoschem.github.io/eixport/reference/wrf_put.html" class="external-link">wrf_put</a></span><span class="op">(</span>file <span class="op">=</span> <span class="va">path_to_wrfc</span>, name <span class="op">=</span> <span class="st">"E_CO"</span>, POL <span class="op">=</span> <span class="va">gr</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="creating-a-wrfchem-input-file-using-as4wrf">Creating a WRFChem Input file using AS4WRF<a class="anchor" aria-label="anchor" href="#creating-a-wrfchem-input-file-using-as4wrf"></a>
</h4>
<ol style="list-style-type: decimal">
<li>Create a grid using <a href="https://atmoschem.github.io/vein/reference/make_grid.html" class="external-link">make_grid</a> and your net.</li>
<li>Run <a href="https://atmoschem.github.io/vein/reference/emis_grid.html" class="external-link">emis_grid</a> to grid your emissions.</li>
<li>Run <a href="https://atmoschem.github.io/eixport/reference/to_as4wrf.html" class="external-link">eixport::to_as4wrf</a> to create a data.frame the specifications for AS4WRF.ncl.</li>
<li>Export data.frame to a text.file. Recall that AS4WRF requires all the lumped species.</li>
<li>Contact the developer of AS4WRF Angel Vara <a href="mailto:alvv1986@gmail.com" class="email">alvv1986@gmail.com</a> to get a copy and run AS4WRF.ncl.</li>
</ol>
<p>Thanks and enjoy VEIN!</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>If you use VEIN, please, cite it (<a href="https://gmd.copernicus.org/articles/11/2209/2018/gmd-11-2209-2018.bib" class="external-link">BIBTEX</a>, <a href="https://gmd.copernicus.org/articles/11/2209/2018/gmd-11-2209-2018.ris" class="external-link">ENDNOTE</a>):</p>
<p>Ibarra-Espinosa, S., Ynoue, R., O’Sullivan, S., Pebesma, E., Andrade, M. D. F., and Osses, M.: VEIN v0.2.2: an R package for bottom-up vehicular emissions inventories, Geosci. Model Dev., 11, 2209-2229, <a href="https://doi.org/10.5194/gmd-11-2209-2018" class="external-link uri">https://doi.org/10.5194/gmd-11-2209-2018</a>, 2018.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="sc">@</span>article{gmd<span class="dv">-11-2209-2018</span>,</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>author <span class="ot">=</span> {Ibarra<span class="sc">-</span>Espinosa, S. and Ynoue, R. and O<span class="st">'Sullivan, S. and Pebesma, E. and Andrade, M. D. F. and Osses, M.},</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="st">title = {VEIN v0.2.2: an R package for bottom--up vehicular emissions inventories},</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="st">journal = {Geoscientific Model Development},</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="st">volume = {11},</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="st">year = {2018},</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="st">number = {6},</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="st">pages = {2209--2229},</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="st">url = {https://gmd.copernicus.org/articles/11/2209/2018/},</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="st">doi = {10.5194/gmd-11-2209-2018}</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="special-thanks-to-all-the-contributors">Special thanks to all the contributors<a class="anchor" aria-label="anchor" href="#special-thanks-to-all-the-contributors"></a>
</h2>
<ul>
<li><a href="https://github.com/Schuch666" class="external-link">Daniel Schuch</a></li>
<li><a href="https://github.com/aadler" class="external-link">Avraham Adler</a></li>
<li><a href="https://github.com/pedro-andrade-inpe" class="external-link">Pedro Andrade</a></li>
<li><a href="https://github.com/edzer" class="external-link">Edzer Pebesma</a></li>
<li><a href="https://github.com/salvatirehbein" class="external-link">Amanda Rehbein</a></li>
<li><a href="https://github.com/joaobazzo" class="external-link">Joao Bazzo</a></li>
</ul>
</div>
<div class="section level2">
<h2 id="communications-doubts-etc">Communications, doubts etc<a class="anchor" aria-label="anchor" href="#communications-doubts-etc"></a>
</h2>
<ul>
<li>Earth-Sciences on Stackoverflow, tag <a href="https://earthscience.stackexchange.com/questions/tagged/vein-r-package" class="external-link">vein-r-package</a>
</li>
<li>Drop me an email <a href="mailto:sergio.ibarra@usp.br" class="email">sergio.ibarra@usp.br</a> or <a href="mailto:zergioibarra@hotmail.com" class="email">zergioibarra@hotmail.com</a> (你好中国朋友 - Hello Chinese friends!)</li>
<li>Check the group on GoogleGroups <a href="https://groups.google.com/d/forum/veinmodel" class="external-link">Group</a>.</li>
<li>Check the project on <a href="https://www.researchgate.net/project/VEIN-An-R-package-for-vehicular-emissions-inventories" class="external-link">ResearchGate</a>.</li>
</ul>
</div>
<div class="section level2">
<h2 id="issues">Issues<a class="anchor" aria-label="anchor" href="#issues"></a>
</h2>
<p>If you encounter any issues while using VEIN, please submit your issues to: <a href="https://github.com/atmoschem/vein/issues/" class="external-link uri">https://github.com/atmoschem/vein/issues/</a> If you have any suggestions just let me know to <a href="mailto:sergio.ibarra@usp.br" class="email">sergio.ibarra@usp.br</a>.</p>
<div class="section level3">
<h3 id="contributing">Contributing<a class="anchor" aria-label="anchor" href="#contributing"></a>
</h3>
<p>Please, read <a href="https://github.com/atmoschem/vein/blob/master/CONTRIBUTING.md" class="external-link">this</a> guide. Contributions of all sorts are welcome, issues and pull requests are the preferred ways of sharing them. When contributing pull requests, please follow the <a href="https://google.github.io/styleguide/Rguide.xml" class="external-link">Google’s R Style Guide</a>. This project is released with a <a href="https://github.com/atmoschem/vein/blob/master/CODE_OF_CONDUCT.md" class="external-link">Contributor Code of Conduct</a>. By participating in this project you agree to abide by its terms.</p>
</div>
<div class="section level3">
<h3 id="note-for-non-english-and-anaconda-users">Note for non-english and anaconda users<a class="anchor" aria-label="anchor" href="#note-for-non-english-and-anaconda-users"></a>
</h3>
<p>Sometimes you need to install R and all dependencies and a way for doing that is using anaconda. Well, as my system is in portuguese, after installing R using anaconda it changed the decimal character to ‘,’. In order to change it back to english meaning decimal separator as ‘.’, I added this variable into the .bashrc</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>nano <span class="sc">~</span><span class="er">/</span>.bashrc</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>export Lang<span class="ot">=</span>C</span></code></pre></div>
<p>More details on <a href="https://stackoverflow.com/questions/13575180/how-to-change-language-settings-in-r" class="external-link">StackOverflow</a></p>
<!-- You can learn more about VEIN reading the documentation in [PDF](https://cran.r-project.org/web/packages/vein/vein.pdf), [online](https://atmoschem.github.io/vein/), reading the book [online](https://ibarraespinosa.github.io/VEINBOOK/), or buy it in  [Kindle](https://www.amazon.com/VEINBOOK-Estimating-vehicular-emissions-package-ebook-dp-B07L7XRFKC/dp/B07L7XRFKC/ref=mt_kindle?_encoding=UTF8&me=&qid=) or  [Paperback](https://www.amazon.com/gp/product/1791571158?pf_rd_p=1581d9f4-062f-453c-b69e-0f3e00ba2652&pf_rd_r=EMDPZM3G7BWCHAD9F4QP) -->
<!-- ![](https://i.imgur.com/RcfNmDm.jpg) -->
</div>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=vein" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/atmoschem/vein/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/atmoschem/vein/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing vein</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://ibarraespinosa.github.io" class="external-link">Sergio Ibarra-Espinosa</a> <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-3162-1905" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://ibarraespinosa.github.io" class="external-link">Sergio Ibarra-Espinosa</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
